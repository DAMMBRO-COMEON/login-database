<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>à¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡ & à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™ LINE</title>
    <script type="module">
        // ğŸ‘‰ à¸™à¸³à¹€à¸‚à¹‰à¸² Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

        // âœ… Firebase Config à¸‚à¸­à¸‡à¸„à¸¸à¸“
        const firebaseConfig = {
            apiKey: "AIzaSyD8-EXAMPLEKEY",
            authDomain: "simple-38a5f.firebaseapp.com",
            projectId: "simple-38a5f",
            storageBucket: "simple-38a5f.appspot.com",
            messagingSenderId: "1234567890",
            appId: "1:1234567890:web:abcdef123456"
        };

        // ğŸ”¥ à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function submitForm() {
            let name = document.getElementById("name").value;
            let email = document.getElementById("email").value;
            let message = document.getElementById("message").value;

            if (name === "" || email === "" || message === "") {
                alert("âŒ à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸«à¹‰à¸„à¸£à¸šà¸—à¸¸à¸à¸Šà¹ˆà¸­à¸‡");
                return;
            }

            // ğŸ“¤ à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸› LINE Notify
            let lineToken = "LTjxT4JkNnGjFQ2wzPVNUdxEeTFf0zDzbaby3DSNDMB";
            let lineMessage = `ğŸ“© à¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡à¹ƒà¸«à¸¡à¹ˆ!\nğŸ‘¤ à¸Šà¸·à¹ˆà¸­: ${name}\nğŸ“§ à¸­à¸µà¹€à¸¡à¸¥: ${email}\nğŸ“ à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡: ${message}`;

            fetch("https://notify-api.line.me/api/notify", {
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded",
                    "Authorization": "Bearer " + lineToken
                },
                body: "message=" + encodeURIComponent(lineMessage)
            })
            .then(response => response.json())
            .then(() => alert("âœ… à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢!"))
            .catch(error => console.error("âŒ à¸ªà¹ˆà¸‡ LINE Notify à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§:", error));

            // ğŸ”¥ à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸¥à¸‡ Firebase Firestore
            try {
                await addDoc(collection(db, "survey_responses"), {
                    name: name,
                    email: email,
                    message: message,
                    timestamp: new Date()
                });
                console.log("âœ… à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Firebase à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!");
            } catch (error) {
                console.error("âŒ à¸šà¸±à¸™à¸—à¸¶à¸ Firebase à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§:", error);
            }

            // à¸£à¸µà¹€à¸‹à¹‡à¸•à¸Ÿà¸­à¸£à¹Œà¸¡
            document.getElementById("surveyForm").reset();
        }

        window.submitForm = submitForm;
    </script>
</head>
<body>
    <h2>ğŸ“ à¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡</h2>
    <form id="surveyForm">
        <label>ğŸ‘¤ à¸Šà¸·à¹ˆà¸­:</label>
        <input type="text" id="name" required><br><br>

        <label>ğŸ“§ à¸­à¸µà¹€à¸¡à¸¥:</label>
        <input type="email" id="email" required><br><br>

        <label>ğŸ“ à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡:</label>
        <textarea id="message" required></textarea><br><br>

        <button type="button" onclick="submitForm()">ğŸ“¤ à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥</button>
    </form>
</body>
</html>
